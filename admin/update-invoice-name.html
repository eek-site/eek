<!DOCTYPE html>
<html lang="en">
<head>`n    <!-- Prevent search engine indexing - secure area -->`n    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Invoice Name - Road and Rescue</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="forms.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ROAD AND RESCUE</h1>
            <h2>Update Invoice Name</h2>
        </header>
        
        <div class="form-container">
            <a href="completion.html" class="back-button">Back to Job Completion & Billing</a>
            
            <div class="info-box">
                <strong>Note:</strong> Customer name (Column E) is used for communications.<br>
                Invoice name (Column F) is used for invoicing.
            </div>
            
            <form id="updateInvoiceNameForm" onsubmit="handleUpdateInvoiceName(event)">
                <div class="form-group">
                    <label for="rego">Job Rego *</label>
                    <input type="text" id="rego" name="rego" required placeholder="Enter job registration number">
                    <div class="help-text">Select from yellow-highlighted jobs or enter manually</div>
                </div>
                
                <div class="form-group">
                    <label>Current Customer Name (Column E)</label>
                    <input type="text" id="currentCustomerName" readonly style="background: #f8f9fa;">
                    <div class="help-text">This is for reference only - used for communications</div>
                </div>
                
                <div class="form-group">
                    <label>Current Invoice Name (Column F)</label>
                    <input type="text" id="currentInvoiceName" readonly style="background: #f8f9fa;">
                    <div class="help-text">Current value - will be updated</div>
                </div>
                
                <div class="form-group">
                    <label for="newInvoiceName">New Invoice Name (Column F) *</label>
                    <input type="text" id="newInvoiceName" name="newInvoiceName" required placeholder="Enter company name for invoicing">
                    <div class="help-text">Company name to appear on invoices</div>
                </div>
                
                <div class="warning-box">
                    <strong>Important:</strong> The customer will be automatically notified of this change.
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-submit">Update Invoice Name</button>
                    <button type="button" class="btn-cancel" onclick="window.location.href='completion.html'">Cancel</button>
                </div>
            </form>
        </div>
        
        <footer>
            <button onclick="window.close()" class="btn-exit">Exit</button>
        </footer>
    </div>
    
    <script src="script.js"></script>
    <script>
        // Load current values when rego is entered
        document.getElementById('rego').addEventListener('blur', function() {
            const rego = this.value.trim();
            if (rego) {
                loadInvoiceNameData(rego);
            }
        });
        
        function loadInvoiceNameData(rego) {
            // TODO: Call API to get current customer name and invoice name
            // For now, show placeholder
            console.log('Loading data for rego:', rego);
        }
        
        function handleUpdateInvoiceName(event) {
            event.preventDefault();
            const formData = {
                rego: document.getElementById('rego').value.trim(),
                newInvoiceName: document.getElementById('newInvoiceName').value.trim()
            };
            
            if (!formData.rego || !formData.newInvoiceName) {
                alert('Please fill in all required fields.');
                return;
            }
            
            // TODO: Call API to execute UpdateInvoiceName VBA function
            executeAction('UpdateInvoiceName', formData);
        }
    </script>
</body>
</html>

