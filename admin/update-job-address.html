<!DOCTYPE html>
<html lang="en">
<head>`n    <!-- Prevent search engine indexing - secure area -->`n    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Job Address by Rego - Road and Rescue</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="forms.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ROAD AND RESCUE</h1>
            <h2>Update Job Address by Rego</h2>
        </header>
        
        <div class="form-container">
            <a href="../../admin/dispatch.html" class="back-button">Back to Dispatch & Setup</a>
            
            <form id="updateAddressForm" onsubmit="handleUpdateAddress(event)">
                <div class="form-group">
                    <label for="rego">Job Rego *</label>
                    <input type="text" id="rego" name="rego" required placeholder="Enter job registration number">
                    <div class="help-text">Select from yellow-highlighted jobs or enter manually</div>
                </div>
                
                <div class="form-group">
                    <label>Current Address</label>
                    <input type="text" id="currentAddress" readonly style="background: #f8f9fa;">
                    <div class="help-text">Current address from Book a Job sheet</div>
                </div>
                
                <div class="form-group">
                    <label for="newAddress">New Address *</label>
                    <textarea id="newAddress" name="newAddress" required placeholder="Enter the new address"></textarea>
                    <div class="help-text">Full address including street, suburb, city</div>
                </div>
                
                <div class="warning-box">
                    <strong>Important:</strong> The customer will be automatically notified of this address change.
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-submit">Update Address</button>
                    <button type="button" class="btn-cancel" onclick="window.location.href='dispatch.html'">Cancel</button>
                </div>
            </form>
        </div>
        
        <footer>
            <button onclick="window.close()" class="btn-exit">Exit</button>
        </footer>
    </div>
    
    <script src="script.js"></script>
    <script>
        document.getElementById('rego').addEventListener('blur', function() {
            const rego = this.value.trim();
            if (rego) {
                loadAddressData(rego);
            }
        });
        
        function loadAddressData(rego) {
            // TODO: Call API to get current address
            console.log('Loading address for rego:', rego);
        }
        
        function handleUpdateAddress(event) {
            event.preventDefault();
            const formData = {
                rego: document.getElementById('rego').value.trim(),
                newAddress: document.getElementById('newAddress').value.trim()
            };
            
            if (!formData.rego || !formData.newAddress) {
                alert('Please fill in all required fields.');
                return;
            }
            
            executeAction('UpdateJobAddressByRego', formData);
        }
    </script>
</body>
</html>

