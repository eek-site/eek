<!DOCTYPE html>
<html lang="en">
<head>`n    <!-- Prevent search engine indexing - secure area -->`n    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Supplier Details - Road and Rescue</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="forms.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ROAD AND RESCUE</h1>
            <h2>Update Supplier Details</h2>
        </header>
        
        <div class="form-container">
            <a href="supplier.html" class="back-button">Back to Supplier Communication</a>
            
            <form id="updateSupplierForm" onsubmit="handleUpdateSupplier(event)">
                <div class="form-group">
                    <label for="rego">Job Rego *</label>
                    <input type="text" id="rego" name="rego" required placeholder="Enter job registration number">
                    <div class="help-text">Select from yellow-highlighted jobs or enter manually</div>
                </div>
                
                <div class="form-group" id="supplierSelectionGroup" style="display: none;">
                    <label for="supplierSelect">Select Supplier *</label>
                    <select id="supplierSelect" name="supplierSelect" required>
                        <option value="">-- Loading suppliers --</option>
                    </select>
                    <div class="help-text">Multiple suppliers may be available for this rego</div>
                </div>
                
                <div id="supplierFields" style="display: none;">
                    <h3 style="margin-top: 20px; margin-bottom: 15px;">Update Supplier Fields</h3>
                    
                    <div class="form-group">
                        <label for="supplierName">Supplier Name</label>
                        <input type="text" id="supplierName" name="supplierName" placeholder="Leave blank to keep current">
                        <div class="help-text">Current value shown above field</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="costings">Costings</label>
                        <input type="text" id="costings" name="costings" placeholder="Leave blank to keep current">
                    </div>
                    
                    <div class="form-group">
                        <label for="bankAccount">Bank Account</label>
                        <input type="text" id="bankAccount" name="bankAccount" placeholder="Leave blank to keep current">
                    </div>
                    
                    <div class="form-group">
                        <label for="suppEmail">Supplier Email</label>
                        <input type="email" id="suppEmail" name="suppEmail" placeholder="Leave blank to keep current">
                    </div>
                    
                    <div class="form-group">
                        <label for="suppPhone">Supplier Phone</label>
                        <input type="tel" id="suppPhone" name="suppPhone" placeholder="Leave blank to keep current">
                    </div>
                </div>
                
                <div class="warning-box" id="notificationBox" style="display: none;">
                    <strong>Note:</strong> The supplier will be automatically notified of any changes made.
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-submit" id="submitBtn" disabled>Update Supplier Details</button>
                    <button type="button" class="btn-cancel" onclick="window.location.href='supplier.html'">Cancel</button>
                </div>
            </form>
        </div>
        
        <footer>
            <button onclick="window.close()" class="btn-exit">Exit</button>
        </footer>
    </div>
    
    <script src="script.js"></script>
    <script>
        let currentSupplierData = {};
        
        document.getElementById('rego').addEventListener('blur', function() {
            const rego = this.value.trim();
            if (rego) {
                loadSuppliersForRego(rego);
            }
        });
        
        document.getElementById('supplierSelect').addEventListener('change', function() {
            const supplierIndex = this.value;
            if (supplierIndex) {
                loadSupplierDetails(supplierIndex);
            }
        });
        
        function loadSuppliersForRego(rego) {
            // TODO: Call API to get suppliers for rego
            // For now, show placeholder
            console.log('Loading suppliers for rego:', rego);
            document.getElementById('supplierSelectionGroup').style.display = 'block';
        }
        
        function loadSupplierDetails(supplierIndex) {
            // TODO: Call API to get supplier details
            console.log('Loading supplier details for index:', supplierIndex);
            document.getElementById('supplierFields').style.display = 'block';
            document.getElementById('notificationBox').style.display = 'block';
            document.getElementById('submitBtn').disabled = false;
        }
        
        function handleUpdateSupplier(event) {
            event.preventDefault();
            const formData = {
                rego: document.getElementById('rego').value.trim(),
                supplierIndex: document.getElementById('supplierSelect').value,
                supplierName: document.getElementById('supplierName').value.trim(),
                costings: document.getElementById('costings').value.trim(),
                bankAccount: document.getElementById('bankAccount').value.trim(),
                suppEmail: document.getElementById('suppEmail').value.trim(),
                suppPhone: document.getElementById('suppPhone').value.trim()
            };
            
            if (!formData.rego || !formData.supplierIndex) {
                alert('Please select a rego and supplier.');
                return;
            }
            
            executeAction('UpdateSupplierDetails', formData);
        }
    </script>
</body>
</html>

