<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Emergency Mobile Mechanic Services - Eek Mobile Mechanical</title>
  <meta name="description" content="Book emergency mobile mechanic services with Eek Mobile Mechanical. Battery jump start, fuel extraction, mechanical diagnostics. Professional service across New Zealand." />
  <meta name="keywords" content="mobile mechanic, emergency mechanic, battery jump start, wrong fuel removal, mobile mechanic NZ" />
  <meta property="og:title" content="Emergency Mobile Mechanic Services - Eek Mobile Mechanical" />
  <meta property="og:description" content="Book emergency mobile mechanic services with Eek Mobile Mechanical. Battery jump start, fuel extraction, mechanical diagnostics. Professional service across New Zealand." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.eek.nz/book-service" />
  <meta property="og:image" content="https://www.eek.nz/og-image.jpg" />

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <!-- Load base styles from main site -->
  <link rel="stylesheet" href="/eek-style-guide.css">
</head>
<body>

<!-- BANNER - Managed by master config -->
<div id="closedBanner" class="after-hours-banner">
  <h2 id="closedTitle">Currently Closed</h2>
  <div id="afterHoursMessage">
    <p><strong>Business Hours:</strong></p>
    <p>Monday - Friday: 7:00 AM - 5:00 PM</p>
    <p>Saturday - Sunday: 7:00 AM - 12:00 PM</p>
    <p>Please call during business hours or book online for next available service</p>
  </div>
  <div id="tempUnavailableMessage" style="display: none;">
    <p><strong>We're currently experiencing high demand</strong></p>
    <p>Our mechanics are fully dispatched on emergency calls</p>
    <p>Please book online for the next available appointment or try calling again shortly</p>
    <a href="#service-selection" class="emergency-btn after-hours-btn" data-track="customer_book_online">Book Online Now</a>
  </div>
</div>

<!-- PAYMENT BLOCK - Managed by master config -->
<section id="stripePaymentBlock">
  <div>
    <h1>Secure Roadside Payment</h1>
    <p>Confirm your payment to get help on the way — fast, safe, and secure.</p>
    <label>
      <input type="checkbox" id="termsCheckbox" />
      <span>I agree to the Eek Mobile Mechanical terms of service 
        <a href="https://www.eek.nz/terms" target="_blank" data-track="legal_terms">
          View terms of use
        </a>
      </span>
    </label>
    <br><br>
    <button id="payNowButton" class="eek-hidden">Pay Now</button>
  </div>
</section>

<!-- HEADER -->
<header>
  <img src="/brand-image.png" alt="Eek Mobile Mechanical - Mobile Mechanic Services" class="eek-brand-image" />
  <div class="business-name">Eek Mobile Mechanical</div>
  <h1 id="headerTitle">Emergency Mobile Mechanic Service</h1>
  <p class="tagline" id="headerSubtitle">Mobile Mechanic • Pre Purchase Inspections • Wrong Fuel Removal • Emergency Roadside Repairs • 30–60 Min Response</p>
  <a class="cta-button phone-link normal-hours-btn" href="tel:0800769000" data-track="header_call">Call <span class="phone-display">0800 769 000</span></a>
  <a class="cta-button after-hours-btn" href="#service-selection" data-track="customer_book_online" data-service="jumpstart" style="display: none;">Book Emergency Service</a>
</header>

<!-- BREADCRUMB -->
<div class="breadcrumb">
  <a href="/" data-track="breadcrumb_home">Home</a> > 
  <a href="/more-options" data-track="breadcrumb_more_options">More Options</a> > 
  <span id="breadcrumbText">Emergency Service</span>
</div>

<!-- MAIN BOOKING CONTAINER -->
<div class="booking-container">
  <div class="booking-header" id="bookingHeader">
    <h2 id="bookingTitle">Book Your Emergency Service</h2>
    <p id="bookingDescription">Professional mobile mechanic service across New Zealand</p>
    <div class="service-stats">
      <div class="stats-grid" id="statsContent"></div>
    </div>
    
    <!-- Business Context Notice - Enhanced from master config -->
    <div id="businessContextNotice" class="business-notice" style="display: none;">
      <h4 id="businessContextTitle">Service Information</h4>
      <p id="businessContextMessage">We'll provide the best possible service for your situation.</p>
    </div>
  </div>

  <!-- PROGRESS BAR -->
  <div class="progress-bar">
    <div class="progress-step active" id="step1-progress"><span>Details</span></div>
    <div class="progress-step" id="step2-progress"><span id="step2Label">Scheduling</span></div>
    <div class="progress-step" id="step3-progress"><span>Confirm</span></div>
  </div>

  <!-- BOOKING STEPS -->
  <div class="booking-steps">
    
    <!-- STEP 1: SERVICE DETAILS -->
    <div class="step active" id="step1">
      <h3 id="step1Title">Step 1: Service Details</h3>

      <!-- Emergency type selector for WINZ -->
      <div id="emergencySelector" class="emergency-selector" style="display: none;">
        <label>1. What is your emergency? <span class="required">*</span></label>
        <div id="emergencyOptions"></div>
      </div>

      <!-- CUSTOMER INFORMATION -->
      <div class="info-section">
        <h4>Your Information</h4>
        <div class="contact-info">
          <label for="nameInput">Full Name (required)</label>
          <input type="text" id="nameInput" placeholder="John Smith" required autocomplete="name"/>
          
          <label for="phoneInput">Phone Number (required)</label>
          <input type="tel" id="phoneInput" placeholder="021 234 5678" required inputmode="tel" autocomplete="tel"/>
          
          <label for="emailInput">Email Address (required)</label>
          <input type="email" id="emailInput" placeholder="your.email@example.com" required autocomplete="email"/>
        </div>
      </div>

      <!-- VEHICLE INFORMATION -->
      <div class="info-section">
        <h4>Vehicle Information</h4>
        <div class="contact-info">
          <div class="form-row">
            <div class="form-col">
              <label for="regoInput">Registration Number (required)</label>
              <input type="text" id="regoInput" placeholder="ABC123" required autocapitalize="characters" spellcheck="false"/>
            </div>
            <div class="form-col">
              <label for="yearInput">Year (required)</label>
              <input type="text" id="yearInput" placeholder="2018" maxlength="4" required pattern="\\d{4}" inputmode="numeric"/>
            </div>
          </div>
          <div class="form-row">
            <div class="form-col">
              <label for="makeInput">Make (required)</label>
              <input type="text" id="makeInput" placeholder="Toyota" required/>
            </div>
            <div class="form-col">
              <label for="modelInput">Model (required)</label>
              <input type="text" id="modelInput" placeholder="Corolla" required/>
            </div>
          </div>
        </div>
      </div>

      <!-- VOLTAGE SELECTOR -->
      <div id="voltageSelector" class="voltage-wrap" style="display: none;">
        <div class="voltage-title">Select battery voltage (required for jump starts)</div>
        <div class="voltage-grid" id="voltageGrid"></div>
      </div>

      <!-- LOCATION -->
      <div class="form-group">
        <label for="locationInput">Where do you need service?</label>
        <input type="text" class="location-input" id="locationInput" placeholder="Enter your address, suburb, or region" required autocomplete="street-address"/>
      </div>

      <!-- DETAILS -->
      <div class="form-group">
        <label for="detailsInput" id="detailsLabel">Tell us more about your situation:</label>
        <textarea class="details-input" id="detailsInput" placeholder="Describe the issue or what you need help with..."></textarea>
      </div>

      <!-- SERVICE INFO BOX -->
      <div class="info-box" id="serviceInfoBox"></div>

      <!-- NEXT BUTTON -->
      <div class="button-container">
        <button class="button" id="nextBtn" data-track="booking_step_1_complete">Next: Select Time</button>
      </div>
    </div>

    <!-- STEP 2: SCHEDULING -->
    <div class="step" id="step2">
      <h3 id="step2Title">Step 2: When do you need service?</h3>

      <div class="timing-notice" id="timingNotice">
        <h4>Important Timing Information</h4>
        <p><strong>Time windows are approximate arrival times.</strong> As a mobile service, a previous job may run long. We'll text you when your tech is on the way.</p>
      </div>

      <div class="urgency-options" id="urgencyOptions"></div>

      <div class="button-container">
        <button class="button secondary" id="backBtn" data-track="booking_back_to_step_1">Back</button>
        <button class="button" id="confirmTimeBtn" disabled data-track="booking_step_2_complete">Continue</button>
      </div>
    </div>

    <!-- STEP 3: CONFIRMATION -->
    <div class="step" id="step3">
      <h3 id="step3Title">Step 3: Review and confirm</h3>

      <div class="reservation-summary">
        <h4>Your Service Request</h4>
        <div class="summary-item"><span>Service:</span><strong id="summaryService"></strong></div>
        <div class="summary-item" id="summaryEmergencyRow" style="display: none;"><span>Emergency Type:</span><strong id="summaryEmergency"></strong></div>
        <div class="summary-item"><span>Location:</span><strong id="summaryLocation"></strong></div>
        <div class="summary-item"><span>Phone:</span><strong id="summaryPhone"></strong></div>
        <div class="summary-item" id="summaryVoltageRow" style="display: none;"><span>Battery Voltage:</span><strong id="summaryVoltage"></strong></div>
        <div class="summary-item" id="summaryUrgencyRow"><span>Response Time:</span><strong id="summaryUrgency"></strong></div>
        <div class="summary-item" id="summaryPriceRow"><span>Service Fee:</span><strong id="summaryPrice"></strong></div>
      </div>

      <div class="timing-notice next-steps-box">
        <h4>What happens next?</h4>
        <p>1. Click "Generate Payment Link" to create your secure payment link</p>
        <p>2. Complete payment through Stripe's secure checkout</p>
        <p>3. Receive SMS confirmation with your booking details</p>
        <p>4. Get a notification when your technician is on the way</p>
      </div>

      <div class="terms-section">
        <h4>Terms and Conditions</h4>
        <div class="terms-checkbox">
          <input type="checkbox" id="termsAgree" />
          <div class="terms-text">
            I agree to the <a href="/terms" target="_blank" data-track="legal_terms">Eek Mobile Mechanical Terms of Service</a> and understand that:
            <ul id="termsList"></ul>
          </div>
        </div>
      </div>

      <div class="button-container">
        <div class="button-group">
          <button class="button secondary" id="backToStep2Btn" data-track="booking_back_to_step_2">Back to Selection</button>
          <button class="button" id="generatePaymentBtn" disabled data-track="booking_payment_request">Generate Payment Link</button>
        </div>
        <p class="payment-note" id="paymentNote">Secure payment processing powered by Stripe</p>
      </div>
    </div>
  </div>
</div>

<!-- STICKY BUTTONS - Managed by master config -->
<a id="stripePaymentSticky" class="sticky-payment" href="#" data-track="customer_call">Make Payment</a>

<!-- FOOTER -->
<footer>
  &copy; 2025 Eek Mobile Mechanical. All rights reserved. | 
  <a href="/privacy" target="_blank" data-track="footer_privacy">Privacy Policy</a> | 
  <a href="/more-options" data-track="more_options_call">More Options</a>
</footer>

<!-- STICKY CALL BUTTONS - Managed by master config -->
<a class="sticky-call phone-link" href="tel:0800769000" data-track="sticky_call" id="stickyCallButton">Call <span class="phone-display">0800 769 000</span></a>
<a class="sticky-call" href="#closedBanner" id="stickyClosedButton" data-track="customer_support" style="display: none;">View Hours</a>

<!-- MASTER CONFIG LOADS FIRST -->
<script src="/eek-master-config.js"></script>

<!-- BOOKING-SPECIFIC JAVASCRIPT (USES MASTER CONFIG ONLY) -->
<script>
// Service configurations
const serviceConfigs = {
  'jumpstart': {
    title:'Battery Jump Start Service',
    subtitle:"Dead battery? We'll get you started!",
    breadcrumb:'Battery Jump Start',
    bookingTitle:'Battery Jump Start Service',
    bookingDescription:'Professional jump start service • Includes battery health check',
    step1Title:'Step 1: Tell us about your battery situation',
    detailsLabel:'Any additional details about the battery problem:',
    detailsPlaceholder:"e.g., Age of battery, if lights were left on, how long it's been dead, etc.",
    serviceCode:'JUMP',
    basePrice:149,
    voltages: [
      { id:'12v', label:'12V (cars, SUVs, utes)', price:149 },
      { id:'24v', label:'24V (trucks, buses)', price:229 }
    ],
    stats:[
      {number:'30–90',text:'min arrival'},
      {number:'Free',text:'battery test'},
      {number:'All',text:'makes & models'},
      {number:'Insured',text:'service'}
    ],
    urgencyOptions:[
      {id:'emergency',title:'Emergency Service',time:'30–90 minutes arrival',description:'Technician dispatched immediately',hidePrice:true}
    ],
    infoContent:`
      <h4>Our Jump Start Service Includes:</h4>
      <ul>
        <li><strong>Professional jump start</strong> using commercial-grade equipment</li>
        <li><strong>Battery voltage test</strong> to check current condition</li>
        <li><strong>Charging system check</strong> to ensure alternator is working</li>
        <li><strong>Battery terminal cleaning</strong> if needed</li>
        <li><strong>Advice on battery replacement</strong> if required</li>
      </ul>`,
    terms:[
      'Service includes professional jump start and battery health assessment',
      'Price calculated based on your vehicle type',
      'Arrival times are approximate - we will SMS you when the technician is on the way',
      'Payment required via secure Stripe checkout'
    ]
  },
  'mechanic': {
    title:'Mobile Mechanic Diagnostic Service',
    subtitle:"Engine problems? We'll diagnose the issue!",
    breadcrumb:'Mechanic Diagnostic',
    bookingTitle:'Mobile Mechanic Diagnostic Service',
    bookingDescription:'Professional mechanical diagnostic • On-site assessment',
    step1Title:'Step 1: Tell us about your mechanical problem',
    detailsLabel:'Describe the symptoms and any issues:',
    detailsPlaceholder:"e.g., Engine won't start, warning lights, strange noises, overheating, etc.",
    serviceCode:'DIAG',
    basePrice:249,
    stats:[
      {number:'30–90',text:'min arrival'},
      {number:'Full',text:'diagnostic scan'},
      {number:'Expert',text:'assessment'},
      {number:'Written',text:'report'}
    ],
    urgencyOptions:[
      {id:'emergency',title:'Emergency Diagnostic',time:'30–90 minutes arrival',description:'Immediate dispatch for urgent issues',hidePrice:true},
      {id:'scheduled',title:'Scheduled Service',time:'Within 4 hours',description:'Book for later today',hidePrice:true}
    ],
    infoContent:`
      <h4>Our Diagnostic Service Includes:</h4>
      <ul>
        <li><strong>Professional diagnostic scanning</strong> of all vehicle systems</li>
        <li><strong>Mechanical assessment</strong> to identify problems</li>
        <li><strong>Written report</strong> of findings and recommendations</li>
        <li><strong>Cost estimate</strong> for any required repairs</li>
        <li><strong>Expert advice</strong> on next steps</li>
      </ul>`,
    terms:[
      'Service includes comprehensive diagnostic scanning and assessment',
      'Price calculated based on your requirements',
      'Written report provided with findings',
      'Arrival times are approximate due to the nature of mechanical work'
    ]
  },
  'fuel-extraction': {
    title:'Wrong Fuel Extraction Service',
    subtitle:"Put wrong fuel in? We'll extract it safely!",
    breadcrumb:'Fuel Extraction',
    bookingTitle:'Emergency Fuel Extraction Service',
    bookingDescription:"Professional fuel extraction • Don't start the engine!",
    step1Title:'Step 1: Tell us about the fuel situation',
    detailsLabel:'Critical details about what happened:',
    detailsPlaceholder:'e.g., How much wrong fuel, have you started engine, petrol in diesel or vice versa, etc.',
    serviceCode:'FUEL',
    basePrice:399,
    stats:[
      {number:'30–90',text:'min arrival'},
      {number:'Mobile',text:'extraction first'},
      {number:'100%',text:'insured service'},
      {number:'Complete',text:'system flush'}
    ],
    urgencyOptions:[
      {id:'mobile',title:'Mobile Extraction Service',time:'30–90 minutes arrival',description:'On-site fuel extraction and system flush',price:399},
      {id:'workshop',title:'Workshop Service',time:'Vehicle collection + workshop completion',description:'Complete workshop extraction with comprehensive system service',price:849}
    ],
    infoContent:`
      <h4>CRITICAL: DO NOT START THE ENGINE</h4>
      <ul>
        <li><strong>Professional extraction</strong> of contaminated fuel</li>
        <li><strong>Complete system flush</strong> to remove all traces</li>
        <li><strong>Fresh fuel replacement</strong> with correct fuel type</li>
        <li><strong>System testing</strong> to ensure safe operation</li>
        <li><strong>Fully insured service</strong> for your protection</li>
        <li><strong>Professional assessment</strong> will determine the best approach for your situation</li>
      </ul>`,
    terms:[
      'In some cases, transfer to workshop may be necessary. Towing costs not included in service price. Additional fees may apply.'
    ]
  },
  'winz': {
    title:'WINZ Vehicle Repair Quote',
    subtitle:'Get an instant quote for Work and Income assistance',
    breadcrumb:'WINZ Quote',
    bookingTitle:'WINZ Vehicle Repair Quote',
    bookingDescription:'Approved WINZ supplier • Instant quotes for vehicle repairs',
    step1Title:'Start Here.',
    step2Title:'Step 2: Generate Your WINZ Quote',
    detailsLabel:'2. Describe the problem in detail:',
    detailsPlaceholder:'Please provide as much detail as possible about the issue...',
    serviceCode:'WINZ',
    basePrice:0,
    hidePrice:true,
    isWinz:true,
    stats:[
      {number:'WINZ',text:'approved supplier'},
      {number:'Instant',text:'quote generation'},
      {number:'Up to $400',text:'assistance available'},
      {number:'1-2 days',text:'approval time'}
    ],
    emergencyTypes: [
      {id:'battery',label:'Flat Battery',description:'Battery won\'t start, needs jump start or replacement'},
      {id:'mechanical',label:'Mechanical Breakdown',description:'Engine problems, won\'t start, warning lights'},
      {id:'misfuel',label:'Misfuel',description:'Wrong fuel in tank (petrol in diesel or vice versa)'}
    ],
    urgencyOptions:[
      {id:'standard',title:'WINZ Quote Generation',time:'Instant digital quote',description:'Submit to Work and Income for approval',hidePrice:true}
    ],
    infoContent:`
      <h4>How This Works:</h4>
      <ul>
        <li><strong>Select your emergency type</strong> from the options above</li>
        <li><strong>Provide vehicle and contact details</strong></li>
        <li><strong>Describe the problem</strong> in as much detail as possible</li>
        <li><strong>Receive instant quote</strong> to submit to WINZ</li>
        <li><strong>Take quote to WINZ</strong> or upload to MyMSD</li>
      </ul>`,
    terms:[
      'Quote valid for 30 days from generation',
      'Subject to WINZ approval and eligibility criteria',
      'Service provided after WINZ approval confirmed',
      'Mobile service - we come to your location'
    ]
  }
};

// API URLs
const POWER_AUTOMATE_URL = 'https://default61ffc6bcd9ce458b8120d32187c377.0d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/dbc93a177083499caf5a06eeac87683c/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=vXidGdo8qErY4QVv03JeNaGbA79eWEoiOxuDocljL6Q';
const WINZ_API_URL = 'https://default61ffc6bcd9ce458b8120d32187c377.0d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/95fc801df59b4250a48919ace91c0276/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=mFpTX4gPrz1u1DbdfF3YqHBnAsW3pnAAj-GWXWvBYYc';

// Global state - booking specific only (no duplicate tracking)
let selectedUrgency = null;
let selectedUrgencyDetails = {};
let selectedVoltageId = null;
let selectedVoltagePrice = null;
let selectedEmergencyType = null;
let calculatedPrice = null;

// USES MASTER CONFIG TRACKING ONLY
function sendBookingUpdate(status) {
  if (!window.buildTrackingPayload || !window.sendTrackingEvent) {
    console.warn('Master config tracking functions not available');
    return;
  }

  const additionalData = {
    name: document.getElementById('nameInput').value.trim(),
    phone: document.getElementById('phoneInput').value.replace(/\D/g,''),
    email: document.getElementById('emailInput').value.trim(),
    details: document.getElementById('detailsInput').value || '',
    vehicleRego: document.getElementById('regoInput').value.toUpperCase().replace(/[^A-Z0-9]/g,''),
    year: document.getElementById('yearInput').value.trim(),
    make: document.getElementById('makeInput').value.trim(),
    model: document.getElementById('modelInput').value.trim(),
    service: window.currentService,
    serviceCode: window.currentConfig?.serviceCode,
    serviceTitle: window.currentConfig?.title,
    locationString: document.getElementById('locationInput').value.trim(),
    source: 'booking_form',
    formVersion: '3.0',
    bookingStatus: status,
    
    // Add booking-specific fields based on status
    ...(status === 'time_selected' && {
      selectedTime: selectedUrgencyDetails.time || '',
      selectedUrgency: selectedUrgency,
      calculatedPrice: calculatedPrice || window.currentConfig?.basePrice,
      finalPrice: getTotalPrice()
    }),

    // WINZ specific fields
    ...(window.currentConfig?.isWinz && selectedEmergencyType && {
      emergencyType: selectedEmergencyType,
      quoteAmount: calculatedPrice || getTotalPrice(),
      quoteReference: window.winzQuoteReference
    }),

    // Jumpstart specific
    ...(window.currentService === 'jumpstart' && selectedVoltageId && {
      selectedVoltage: selectedVoltageId,
      batteryVoltage: selectedVoltageId === '12v' ? '12V' : '24V'
    })
  };
  
  const payload = window.buildTrackingPayload('booking_update', status, additionalData);
  return window.sendTrackingEvent(payload);
}

// Initialize booking form - uses master config tracking
function initializeBookingForm() {
  const urlParams = new URLSearchParams(window.location.search);
  const service = urlParams.get('service') || 'jumpstart';
  
  // Redirect inspection to dedicated page
  if (service === 'inspection') {
    window.location.href = `/pre-purchase-vehicle-inspection/${window.location.search}`;
    return;
  }
  
  loadServiceConfig(service);
  setupEventHandlers();
  updateBusinessContext();
  
  // Track conversion using master config
  if (window.trackConversion) {
    window.trackConversion(`${service}_form_loaded`, 'Booking');
  }
  
  // Send initial booking update
  sendBookingUpdate('booking_started');
}

// Update business context using master config
function updateBusinessContext() {
  if (!window.EEK_STATE) return;
  
  const notice = document.getElementById('businessContextNotice');
  const title = document.getElementById('businessContextTitle');
  const message = document.getElementById('businessContextMessage');
  
  const systemActive = window.EEK_STATE.systemActive;
  const duringBusinessHours = window.isWithinBusinessHours ? window.isWithinBusinessHours() : true;
  
  if (!systemActive && duringBusinessHours) {
    notice.style.display = 'block';
    notice.className = 'business-notice high-demand';
    title.textContent = 'High Demand Period';
    message.textContent = 'We\'re currently experiencing high demand. Booking online ensures your place in the queue.';
  } else if (!duringBusinessHours) {
    notice.style.display = 'block';
    notice.className = 'business-notice after-hours';
    title.textContent = 'After Hours Service';
    message.textContent = 'After-hours bookings include a priority service fee. Your request will be processed first thing in the morning.';
  } else {
    notice.style.display = 'none';
  }
}

function loadServiceConfig(serviceType) {
  const config = serviceConfigs[serviceType] || serviceConfigs['jumpstart'];
  
  // Update page content
  document.title = `${config.title} - Eek Mobile Mechanical`;
  document.getElementById('headerTitle').textContent = config.title;
  document.getElementById('headerSubtitle').textContent = config.subtitle;
  document.getElementById('breadcrumbText').textContent = config.breadcrumb;
  document.getElementById('bookingTitle').textContent = config.bookingTitle;
  document.getElementById('bookingDescription').textContent = config.bookingDescription;
  document.getElementById('step1Title').textContent = config.step1Title;
  document.getElementById('detailsLabel').textContent = config.detailsLabel;
  document.getElementById('detailsInput').placeholder = config.detailsPlaceholder;
  document.getElementById('serviceInfoBox').innerHTML = config.infoContent;

  // Handle WINZ styling
  const bookingHeader = document.getElementById('bookingHeader');
  const emergencySelector = document.getElementById('emergencySelector');
  
  if (config.isWinz) {
    bookingHeader.classList.add('winz');
    document.getElementById('step1').classList.add('winz-step');
    document.getElementById('nextBtn').textContent = 'Get Quote';
    document.getElementById('step2Label').textContent = 'Quote';
    
    // Show emergency selector
    emergencySelector.style.display = 'block';
    document.getElementById('emergencyOptions').innerHTML = config.emergencyTypes.map(e => `
      <div class="emergency-option" data-id="${e.id}">
        <input type="radio" name="emergencyType" value="${e.id}" id="emergency_${e.id}">
        <label for="emergency_${e.id}" class="emergency-label">${e.label}</label>
        <p class="emergency-description">${e.description}</p>
      </div>
    `).join('');
  } else {
    bookingHeader.classList.remove('winz');
    document.getElementById('step1').classList.remove('winz-step');
    document.getElementById('nextBtn').textContent = 'Next: Select Time';
    document.getElementById('step2Label').textContent = 'Scheduling';
    emergencySelector.style.display = 'none';
  }

  // Populate stats
  document.getElementById('statsContent').innerHTML = config.stats.map(stat =>
    `<div class="stat-item"><span class="stat-number">${stat.number}</span>${stat.text}</div>`
  ).join('');

  // Handle voltage selection for jumpstart
  const voltageSelector = document.getElementById('voltageSelector');
  if (config.voltages && !config.isWinz) {
    voltageSelector.style.display = 'block';
    document.getElementById('voltageGrid').innerHTML = config.voltages.map(v => `
      <div class="voltage-card" data-id="${v.id}" data-price="${v.price}">
        <div class="voltage-label">${v.label}</div>
        <div class="voltage-price">$${v.price}</div>
      </div>
    `).join('');
  } else {
    voltageSelector.style.display = 'none';
  }

  // Handle terms
  const termsList = document.getElementById('termsList');
  if (config.terms && Array.isArray(config.terms)) {
    termsList.innerHTML = config.terms.map(term => `<li>${term}</li>`).join('');
  } else {
    termsList.innerHTML = '';
  }

  window.currentService = serviceType;
  window.currentConfig = config;
}

function setupEventHandlers() {
  // Emergency type selection with master config tracking
  document.getElementById('emergencyOptions').addEventListener('click', function(e) {
    const option = e.target.closest('.emergency-option');
    if (option) {
      document.querySelectorAll('.emergency-option').forEach(x => x.classList.remove('selected'));
      option.classList.add('selected');
      option.querySelector('input[type="radio"]').checked = true;
      selectedEmergencyType = option.dataset.id;
      
      // Track using master config
      if (window.trackConversion) {
        window.trackConversion(`winz_emergency_${selectedEmergencyType}`, 'Booking');
      }
    }
  });

  // Voltage selection with master config tracking
  document.getElementById('voltageGrid').addEventListener('click', function(e) {
    const card = e.target.closest('.voltage-card');
    if (card) {
      document.querySelectorAll('.voltage-card.selected').forEach(x => x.classList.remove('selected'));
      card.classList.add('selected');
      selectedVoltageId = card.dataset.id;
      selectedVoltagePrice = parseInt(card.dataset.price);
      
      // Track using master config
      if (window.trackConversion) {
        window.trackConversion(`battery_${selectedVoltageId}_selected`, 'Booking');
      }
    }
  });

  // Urgency selection with master config tracking
  document.getElementById('urgencyOptions').addEventListener('click', function(e) {
    const option = e.target.closest('.urgency-option');
    if (option) {
      document.querySelectorAll('.urgency-option.selected').forEach(x => x.classList.remove('selected'));
      option.classList.add('selected');
      selectedUrgency = option.dataset.id;
      selectedUrgencyDetails = {
        title: option.dataset.title,
        time: option.dataset.time,
        price: calculatedPrice || parseInt(option.dataset.price) || 0
      };
      document.getElementById('confirmTimeBtn').disabled = false;
      
      // Track using master config
      if (window.trackConversion) {
        window.trackConversion(`${window.currentService}_urgency_${selectedUrgency}`, 'Booking');
      }
    }
  });

  // Button event handlers
  document.getElementById('nextBtn').addEventListener('click', goToStep2);
  document.getElementById('backBtn').addEventListener('click', goToStep1);
  document.getElementById('confirmTimeBtn').addEventListener('click', goToStep3);
  document.getElementById('backToStep2Btn').addEventListener('click', goToStep2);
  
  document.getElementById('termsAgree').addEventListener('change', function() {
    document.getElementById('generatePaymentBtn').disabled = !this.checked;
    
    if (this.checked && window.trackConversion) {
      window.trackConversion('booking_terms_accepted', 'Booking');
    }
  });
  
  document.getElementById('generatePaymentBtn').addEventListener('click', generatePaymentLink);
}

function goToStep1() {
  document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
  document.getElementById('step1').classList.add('active');
  document.querySelectorAll('.progress-step').forEach(el => el.classList.remove('active','completed'));
  document.getElementById('step1-progress').classList.add('active');
}

async function goToStep2() {
  // Enhanced validation
  const name = document.getElementById('nameInput').value.trim();
  const phone = document.getElementById('phoneInput').value.trim();
  const email = document.getElementById('emailInput').value.trim();
  const location = document.getElementById('locationInput').value.trim();
  const rego = document.getElementById('regoInput').value.trim();
  const year = document.getElementById('yearInput').value.trim();
  const make = document.getElementById('makeInput').value.trim();
  const model = document.getElementById('modelInput').value.trim();
  
  if (!name || !phone || !email || !location || !rego || !year || !make || !model) {
    alert('Please fill in all required fields');
    return;
  }
  
  if (window.currentConfig.isWinz && !selectedEmergencyType) {
    alert('Please select your emergency type');
    return;
  }
  
  if (window.currentService === 'jumpstart' && !window.currentConfig.isWinz && !selectedVoltageId) {
    alert('Please select your battery voltage');
    return;
  }
  
  // Track using master config
  if (window.trackConversion) {
    window.trackConversion(`${window.currentService}_step_1_complete`, 'Booking');
  }
  
  await sendBookingUpdate('details_complete');

  // Move to step 2
  document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
  document.getElementById('step2').classList.add('active');
  document.getElementById('step1-progress').classList.add('completed');
  document.getElementById('step1-progress').classList.remove('active');
  document.getElementById('step2-progress').classList.add('active');

  setupUrgencyOptions();
}

function setupUrgencyOptions() {
  const urgencyContainer = document.getElementById('urgencyOptions');
  
  urgencyContainer.innerHTML = window.currentConfig.urgencyOptions.map(o => {
    let displayPrice = calculatedPrice || window.currentConfig.basePrice;
    
    // Apply service-specific pricing
    if (window.currentService === 'fuel-extraction') {
      displayPrice = o.price;
    } else if (window.currentService === 'jumpstart' && selectedVoltagePrice) {
      displayPrice = selectedVoltagePrice;
    }
    
    const priceHtml = (o.hidePrice || window.currentConfig.hidePrice) ? 
      '<div class="urgency-price calculating">Price in quote</div>' :
      `<div class="urgency-price">$${displayPrice}</div>`;
    
    return `
      <div class="urgency-option" data-id="${o.id}" data-title="${o.title}" data-time="${o.time}" data-price="${o.price || displayPrice}">
        <div class="urgency-title">${o.title}</div>
        <div class="urgency-time">${o.time}</div>
        <div class="urgency-description">${o.description}</div>
        ${priceHtml}
      </div>`;
  }).join('');

  // Auto-select single option
  if (window.currentConfig.urgencyOptions.length === 1) {
    const firstOption = urgencyContainer.querySelector('.urgency-option');
    firstOption.click();
  }
}

async function goToStep3() {
  if (!selectedUrgency) {
    alert('Please select a service time');
    return;
  }

  // Track using master config
  if (window.trackConversion) {
    window.trackConversion('booking_step_2_complete', 'Booking');
  }
  
  await sendBookingUpdate('time_selected');

  // Calculate WINZ pricing
  if (window.currentConfig.isWinz) {
    const prices = { battery: 149, mechanical: 249, misfuel: 849 };
    calculatedPrice = prices[selectedEmergencyType] || 299;
    
    if (!window.winzQuoteReference) {
      window.winzQuoteReference = `WINZ-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`;
    }
  }

  // Move to step 3
  document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
  document.getElementById('step3').classList.add('active');
  document.getElementById('step2-progress').classList.add('completed');
  document.getElementById('step2-progress').classList.remove('active');
  document.getElementById('step3-progress').classList.add('active');

  updateSummary();
}

function getTotalPrice() {
  let basePrice = 0;
  
  if (window.currentConfig.isWinz) {
    return calculatedPrice || 0;
  }
  
  if (window.currentService === 'jumpstart' && selectedVoltagePrice) {
    basePrice = selectedVoltagePrice;
  } else if (window.currentService === 'fuel-extraction' && selectedUrgency) {
    const option = window.currentConfig.urgencyOptions.find(opt => opt.id === selectedUrgency);
    basePrice = option ? option.price : window.currentConfig.basePrice;
  } else {
    basePrice = calculatedPrice || selectedUrgencyDetails.price || window.currentConfig.basePrice;
  }
  
  return basePrice;
}

function updateSummary() {
  document.getElementById('summaryService').textContent = window.currentConfig.title;
  document.getElementById('summaryLocation').textContent = document.getElementById('locationInput').value;
  document.getElementById('summaryPhone').textContent = document.getElementById('phoneInput').value.replace(/\D/g,'');
  
  // Emergency type for WINZ
  if (window.currentConfig.isWinz && selectedEmergencyType) {
    document.getElementById('summaryEmergencyRow').style.display = '';
    const emergencyLabel = window.currentConfig.emergencyTypes.find(e => e.id === selectedEmergencyType)?.label || '';
    document.getElementById('summaryEmergency').textContent = emergencyLabel;
  } else {
    document.getElementById('summaryEmergencyRow').style.display = 'none';
  }

  // Voltage for jumpstart
  if (window.currentService === 'jumpstart' && selectedVoltageId && !window.currentConfig.isWinz) {
    document.getElementById('summaryVoltageRow').style.display = '';
    document.getElementById('summaryVoltage').textContent = selectedVoltageId === '12v' ? '12V' : '24V';
  } else {
    document.getElementById('summaryVoltageRow').style.display = 'none';
  }

  // Update display based on service type
  if (window.currentConfig.isWinz) {
    document.getElementById('summaryUrgencyRow').style.display = 'none';
    document.getElementById('summaryPrice').textContent = `$${getTotalPrice()} (quote for WINZ)`;
    document.getElementById('generatePaymentBtn').textContent = 'Download WINZ Quote';
    document.getElementById('paymentNote').textContent = 'Quote will be emailed and available for download';
  } else {
    document.getElementById('summaryUrgencyRow').style.display = '';
    document.getElementById('summaryUrgency').textContent = selectedUrgencyDetails.time || '';
    document.getElementById('summaryPrice').textContent = `$${getTotalPrice()}`;
  }
}

async function generatePaymentLink() {
  if (!document.getElementById('termsAgree').checked) {
    alert('Please accept the terms and conditions');
    return;
  }

  const btn = document.getElementById('generatePaymentBtn');
  btn.disabled = true;
  
  // Track conversion using master config service values
  const conversionAction = `${window.currentService}_payment_request`;
  if (window.trackConversion) {
    window.trackConversion(conversionAction, 'Booking');
  }
  
  await sendBookingUpdate('terms_accepted');
  
  // Handle WINZ quote generation
  if (window.currentConfig.isWinz) {
    btn.textContent = 'Generating Quote';
    
    try {
      await sendBookingUpdate('winz_quote_sent');
      
      // Use master config tracking for WINZ quote
      const winzPayload = window.buildTrackingPayload ? 
        window.buildTrackingPayload('winz_quote', 'quote_generated', {
          emergencyType: selectedEmergencyType,
          quoteAmount: calculatedPrice || getTotalPrice(),
          quoteReference: window.winzQuoteReference,
          conversionValue: window.EEK_CONFIG?.SERVICE_VALUES?.['winz_quote'] || 20000
        }) : {
          emergencyType: selectedEmergencyType,
          quoteAmount: calculatedPrice || getTotalPrice(),
          quoteReference: window.winzQuoteReference
        };
      
      await fetch(WINZ_API_URL, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(winzPayload)
      });
      
      // Track WINZ conversion with proper value
      if (window.trackConversion) {
        window.trackConversion('winz_quote_generated', 'WINZ');
      }
      
    } catch (err) {
      console.error('WINZ quote error:', err);
    }
    
    btn.textContent = 'Preparing Quote';
    setTimeout(() => { 
      const params = new URLSearchParams();
      params.append('service', window.currentService);
      params.append('emergencyType', selectedEmergencyType || '');
      params.append('price', getTotalPrice());
      if (window.winzQuoteReference) params.append('quoteReference', window.winzQuoteReference);
      window.location.href = `https://www.eek.nz/thanks?${params.toString()}`;
    }, 1500);
    return;
  }
  
  // Handle regular payment generation
  await sendBookingUpdate('payment_pending');
  btn.textContent = 'Generating Link';
  const total = getTotalPrice();
  
  // Enhanced booking data using master config session and tracking data
  const bookingData = {
    rego: document.getElementById('regoInput').value.toUpperCase().replace(/[^A-Z0-9]/g,'') || 'Not provided',
    amount: total * 100,
    currency: 'NZD',
    description: `${window.currentConfig.title} - ${document.getElementById('locationInput').value}`,
    redirectUrl: 'https://www.eek.nz/thanks',
    customerData: {
      name: document.getElementById('nameInput').value.trim(),
      phone: document.getElementById('phoneInput').value.replace(/\D/g,''),
      email: document.getElementById('emailInput').value.trim(),
      location: document.getElementById('locationInput').value.trim(),
      vehicleRego: document.getElementById('regoInput').value.toUpperCase().replace(/[^A-Z0-9]/g,''),
      service: window.currentService,
      serviceCode: window.currentConfig.serviceCode,
      serviceTitle: window.currentConfig.title,
      details: document.getElementById('detailsInput').value || 'No additional details provided',
      price: `${total}`,
      
      // Enhanced data from master config
      gclid: window.EEK_STATE?.storedGclidForTracking,
      sessionId: window.EEK_STATE?.sessionId,
      duringBusinessHours: window.isWithinBusinessHours ? window.isWithinBusinessHours() : false,
      systemActive: window.EEK_STATE?.systemActive,
      phoneNumberType: window.getDisplayPhoneNumber ? 
        (window.getDisplayPhoneNumber().tel === window.EEK_CONFIG?.PHONE_NUMBERS?.tracking.tel ? 'tracking' : 'default') : 'unknown',
      
      // Booking-specific context
      selectedVoltage: selectedVoltageId,
      selectedUrgency: selectedUrgency,
      emergencyType: selectedEmergencyType,
      calculatedPrice: calculatedPrice
    }
  };

  try {
    const response = await fetch(POWER_AUTOMATE_URL, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(bookingData)
    });

    if (response.ok) {
      const result = await response.json();
      if (result.url) {
        // Track successful payment link generation
        const paymentGeneratedAction = `${window.currentService}_payment_generated`;
        if (window.trackConversion) {
          window.trackConversion(paymentGeneratedAction, 'Booking');
        }
        
        setTimeout(() => { window.location.href = result.url; }, 1000);
      } else {
        throw new Error('No payment URL received');
      }
    } else {
      throw new Error('Server returned ' + response.status);
    }
  } catch (err) {
    console.error('Payment link error:', err);
    btn.disabled = false;
    btn.textContent = 'Generate Payment Link';
    
    // Track payment generation failure using master config
    if (window.buildTrackingPayload && window.sendTrackingEvent) {
      const failurePayload = window.buildTrackingPayload('booking_error', 'payment_generation_failed', {
        errorMessage: err.message,
        service: window.currentService,
        totalPrice: total
      });
      window.sendTrackingEvent(failurePayload);
    }
    
    alert('Unable to generate payment link automatically.\n\nPlease call us at 0800 769 000 or try refreshing the page.');
  }
}

// Initialize when DOM is ready - wait for master config
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(initializeBookingForm, 200);
});
</script>

<!-- Additional CSS for booking styles -->
<style>
/* Breadcrumb Navigation */
.breadcrumb {
  background: #f8f9fa;
  padding: 10px 20px;
  margin: 0 auto 20px;
  max-width: 800px;
  border-radius: 8px;
  font-size: 0.9em;
  color: #666;
}

.breadcrumb a {
  color: var(--eek-primary);
  text-decoration: none;
}

.breadcrumb a:hover {
  text-decoration: underline;
}

/* Business Context Notices */
.business-notice {
  background: #e8f4f8;
  padding: 15px;
  border-radius: 8px;
  margin: 15px 0;
  border-left: 4px solid #007bff;
}

.business-notice.high-demand {
  background: #fff3cd;
  border-color: #ffc107;
}

.business-notice.after-hours {
  background: #f8d7da;
  border-color: #dc3545;
}

.business-notice h4 {
  margin: 0 0 8px 0;
  color: #333;
  font-size: 1.1em;
}

.business-notice p {
  margin: 0;
  color: #666;
}

/* BOOKING-SPECIFIC STYLES */
.booking-container {
  max-width: 800px;
  margin: 20px auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  overflow: hidden;
}

.booking-header {
  padding: 30px;
  text-align: center;
  background: linear-gradient(135deg, var(--eek-primary), var(--eek-primary-light));
  color: white;
}

.booking-header.winz {
  background: linear-gradient(135deg, #28a745, #20a142);
}

.booking-header h2 {
  margin: 0 0 10px 0;
  font-size: 2em;
  color: white;
}

.booking-header p {
  margin: 0 0 20px 0;
  font-size: 1.2em;
  opacity: 0.9;
  color: white;
}

.service-stats {
  margin-top: 20px;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 15px;
  max-width: 600px;
  margin: 0 auto;
}

.stat-item {
  background: rgba(255,255,255,0.15);
  padding: 15px 10px;
  border-radius: 8px;
  text-align: center;
  backdrop-filter: blur(10px);
}

.stat-number {
  display: block;
  font-size: 1.5em;
  font-weight: bold;
  margin-bottom: 5px;
  color: white;
}

.progress-bar {
  display: flex;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
}

.progress-step {
  flex: 1;
  padding: 15px;
  text-align: center;
  background: #e9ecef;
  color: #6c757d;
  border-right: 1px solid #dee2e6;
  transition: all 0.3s ease;
}

.progress-step:last-child {
  border-right: none;
}

.progress-step.active {
  background: var(--eek-primary);
  color: white;
}

.progress-step.completed {
  background: var(--eek-success);
  color: white;
}

.booking-steps {
  padding: 30px;
}

.step {
  display: none;
}

.step.active {
  display: block;
}

.step.winz-step {
  background: linear-gradient(135deg, #f8f9fa, #e9ecef);
  padding: 30px;
  border-radius: 12px;
  border: 2px solid #28a745;
}

.info-section {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}

.info-section h4 {
  margin: 0 0 15px 0;
  color: #333;
  font-size: 1.2em;
}

.contact-info {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}

.form-col {
  display: flex;
  flex-direction: column;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 700;
  color: #333;
}

.contact-info label {
  font-weight: 600;
  margin-bottom: 5px;
  color: #333;
}

.contact-info input {
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 1em;
}

.location-input, .details-input {
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 1em;
}

.details-input {
  min-height: 100px;
  resize: vertical;
}

.emergency-selector {
  background: #e8f5e8;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  border: 2px solid #28a745;
}

.emergency-selector label {
  font-size: 1.2em;
  font-weight: bold;
  color: #155724;
  margin-bottom: 15px;
  display: block;
}

.emergency-option {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 10px;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.emergency-option:hover {
  border-color: #28a745;
}

.emergency-option.selected {
  border-color: #28a745;
  background: #f8fff8;
}

.emergency-label {
  font-weight: bold;
  font-size: 1.1em;
  color: #333;
  margin-bottom: 5px;
  display: block;
}

.emergency-description {
  color: #666;
  font-size: 0.95em;
  margin: 5px 0 0 0;
}

.voltage-wrap {
  background: #fff3cd;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  border: 2px solid #ffc107;
}

.voltage-title {
  font-size: 1.2em;
  font-weight: bold;
  color: #856404;
  margin-bottom: 15px;
}

.voltage-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.voltage-card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.3s ease;
  text-align: center;
}

.voltage-card:hover {
  border-color: #ffc107;
}

.voltage-card.selected {
  border-color: #ffc107;
  background: #fffbf0;
}

.voltage-label {
  font-weight: bold;
  margin-bottom: 10px;
  color: #333;
}

.voltage-price {
  font-size: 1.3em;
  font-weight: bold;
  color: #ffc107;
}

.info-box {
  background: #e7f3ff;
  padding: 20px;
  border-radius: 8px;
  margin: 20px 0;
  border-left: 4px solid #007bff;
}

.info-box h4 {
  color: #004085;
  margin-top: 0;
}

.info-box ul {
  margin-bottom: 0;
}

.info-box li {
  margin-bottom: 8px;
}

.timing-notice {
  background: #fff3cd;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  border: 1px solid #ffeaa7;
}

.timing-notice h4 {
  color: #856404;
  margin-top: 0;
}

.next-steps-box {
  background: #e8f4f8;
  border-color: #bee5eb;
}

.urgency-options {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-bottom: 20px;
}

.urgency-option {
  background: white;
  padding: 20px;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.urgency-option:hover {
  border-color: var(--eek-primary);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.urgency-option.selected {
  border-color: var(--eek-primary);
  background: #fff5f5;
}

.urgency-title {
  font-size: 1.3em;
  font-weight: bold;
  color: #333;
  margin-bottom: 8px;
}

.urgency-time {
  font-size: 1.1em;
  color: var(--eek-primary);
  font-weight: 600;
  margin-bottom: 8px;
}

.urgency-description {
  color: #666;
  margin-bottom: 10px;
}

.urgency-price {
  font-size: 1.5em;
  font-weight: bold;
  color: var(--eek-success);
}

.urgency-price.calculating {
  color: #666;
  font-style: italic;
}

.reservation-summary {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}

.reservation-summary h4 {
  margin-top: 0;
  color: #333;
}

.summary-item {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px solid #dee2e6;
}

.summary-item:last-child {
  border-bottom: none;
}

.summary-item span {
  color: #666;
}

.summary-item strong {
  color: #333;
}

.terms-section {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}

.terms-section h4 {
  margin-top: 0;
  color: #333;
}

.terms-checkbox {
  display: flex;
  gap: 10px;
  align-items: flex-start;
}

.terms-checkbox input[type="checkbox"] {
  margin-top: 4px;
  transform: scale(1.2);
}

.terms-text {
  flex: 1;
  font-size: 0.95em;
  line-height: 1.5;
}

.terms-text ul {
  margin: 10px 0 0 20px;
  padding: 0;
}

.terms-text li {
  margin-bottom: 5px;
}

.button-container {
  text-align: center;
  margin: 20px 0;
}

.button-group {
  display: flex;
  justify-content: center;
  gap: 15px;
  flex-wrap: wrap;
}

.button {
  background-color: var(--eek-primary);
  color: white;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  font-size: 1.1em;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
  display: inline-block;
}

.button:hover {
  background-color: var(--eek-primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.button:disabled {
  background-color: #6c757d;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.button.secondary {
  background-color: #6c757d;
  color: white;
}

.button.secondary:hover {
  background-color: #5a6268;
}

.payment-note {
  margin: 15px 0 0 0;
  color: #666;
  font-size: 0.9em;
}

.required {
  color: #dc3545;
  font-weight: bold;
}

/* Responsive design */
@media (max-width: 768px) {
  .booking-container {
    margin: 10px;
  }
  
  .booking-steps {
    padding: 20px;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .voltage-grid {
    grid-template-columns: 1fr;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .button-group {
    flex-direction: column;
    align-items: center;
  }
  
  .button {
    width: 100%;
    max-width: 280px;
  }
  
  .breadcrumb {
    margin: 0 10px 20px;
  }
}
</style>

</body>
</html>
